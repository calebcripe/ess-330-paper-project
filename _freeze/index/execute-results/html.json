{
  "hash": "8e4e5ba23bff4a38b11caf72bc50af6a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Assessing Changes in Snow Water Equivalent in Rocky Mountain National Park with Increasing Annual Air Temperatures \n\nauthors:\n  - name: Caleb Cripe\n    affiliation: Colorado State University\n    roles: writing\n    corresponding: true\n  - name: Caitlin Rasbid\n    affiliation: Colorado State University\n    corresponding: false\nexecute: \n  echo: true\nbibliography: references.bib\ncsl: apa-6th-edition.csl\n---\n\n\n\n\n\n# Abstract\nWith climate change impacts becoming readily felt by various populations with record-breaking air temperatures and more prevalent hurricanes, droughts, and other extreme weather events, it is essential to analyze past trends of ecosystem functions in response to climate change in order to predict and mitigate climate change related events. Of particular interest to the Western United States is the impact of increasing air temperatures on the annual accumulated snowpack which supplies much of the freshwater resources to the drought-prone region. Applying this focus to a local scale, here we utilize SNOTEL snowpack and climate condition data from six sites in Rocky Mountain National Park to assess trends in snowpack and air temperature over the last 20 years. Performing visual data exploration, statistical analyses such as ANOVA and MANOVA, and a time-series decomposition, we were able to see a clear rising trend in air temperature, though snowpack demonstrated less clear trends. Snow pack decreased in the last 20 years at Lake Irene and Phantom Valley post 2011, though other sites like Copeland Lake maintained a relatively stable if not slightly increasing trend in snowpack. The implications of this study provide context to the unpredictable effects of climate change on snow pack in Rocky Mountain National Park, while emphasizing the need for further study over increased time spans.\n\n# Introduction\nClimate change has caused regime alterations across aspects of ecosystems, impacting ecosystems functioning and environmental services societies rely on. Especially in the Western U.S., snowpack that accumulates during the winter is essential to provide water for the drier months of the year, with decreasing snow pack resulting in scarcity. Globally, snowpack substantially contributes to the livelihoods of over a billion people, who are both directly and indirectly dependent on meltwater resources (@irannezhad2022snowpack). Decreased annual snow pack can have adverse impacts on fire conditions, making wildfires that start more dangerous and difficult to control. Reduced meltwater, soil moisture, and fuel moisture can greatly increase fire potential in forest systems, which studies have suggested is already occurring in the Western U.S. (@Gergel2017-vr) These factors underscore the need to analyze trends in snow pack and assess contributing factors so urban populations are able to recognize when droughts are likely to occur and when fire risk is higher than average. \n\nOur research question stemmed from the existing research connecting climate change to decreasing snow pack with varying degrees of impact by region (@irannezhad2022snowpack). We wanted to assess specifically how snow water equivalent (SWE) in Rocky Mountain National Park (RMNP) changed compared to mean air temperature (MAT), given RMNP snow melt provides freshwater to Fort Collins. The data we used was the Snow Telemetry Network (SNOTEL) from the six sites located in RMNP, filtering data to include start of day SWE recorded and daily MAT from the last 20 years. The six sites we analyzed located within RMNP are: Phantom Valley, Lake Irene, Willow Park, Bear Lake, Copeland Lake, and Wild Basin. We analyzed trends visually then confirmed correlation between SWE and MAT using statistical tests. Then we compared the impact of site-specific differences using ANOVA and MANOVA. Sites are explored further individually by conducting visual analysis of individual MAT and SWE trends over the 20 year study period. We then performed a time series analysis to assess to what degree trends were affected by seasonality and randomness within the data. Through this analysis we predicted that increasing MAT has an inverse relationship on SWE in RMNP for the past 20 years. More so, we were interested in specific variations between sites and understanding the impacts of complex, changing weather systems and extreme weather events. \n\n# Methods\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(readr)\ninstall.packages(\"janitor\", repos = \"https://cloud.r-project.org\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nThe downloaded binary packages are in\n\t/var/folders/jn/hk4fnzlx679cs3m0_lnzh7hh0000gn/T//RtmpsB1nQD/downloaded_packages\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(janitor)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'janitor'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nrmnp_snotel <- read_csv(\"rmnp_snotel(rmnp_snotel).csv\") %>%\n  janitor::clean_names()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 9133 Columns: 37\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (1): Date\ndbl (36): Bear Lake (322) Snow Water Equivalent (in) Start of Day Values, Be...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyr)\n\nrmnp_clean <- rmnp_snotel %>%\n  drop_na()\n```\n:::\n\n\n\n\n\n# Results\nOur preliminary visual analysis of aggregate trends within MAT and SWE demonstrated that while the MAT of the six sites increased sharply over the 20 year period, the aggregate SWE of the six sites stayed relatively consistent with a slight overall increase (Fig. 1A, 1B). This prompted us to individually conduct visual analysis for each of the six sites to observe isolated instances of SWE trends. In accordance with our aggregate analysis, all six of the sites demonstrated dramatic temperature increases over the study period regardless of elevation. The individual analysis of SWE revealed that four of the six sites—Bear Lake, Copeland Lake, Wild Basin, and Willow Park—demonstrated increases in SWE in conjunction with increased temperatures (Fig. 2A, 2B, 2E, 2F). The other two sites—Lake Irene and Phantom Valley—exhibited a slight decrease in observed SWE over the 20 year period (Fig. 2C, 2D). There was no correlation between the elevation of each site and the observed SWE, with the highest elevated site, Lake Irene, and the lowest elevated site, Phantom Valley, demonstrating decreased SWE, while the other four sites with median elevations showing increases.\n\n### Aggregate Analysis\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ purrr     1.0.2\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(lubridate)\n\ndf <- rmnp_clean %>%\n  mutate(date = mdy(date),\n         year = year(date))\n\nswe_data <- df %>%\n  select(year, contains(\"snow_water_equivalent\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"swe\"\n  )\n\nswe_data <- swe_data %>%\n  mutate(swe = as.numeric(swe))\n\nannual_swe <- swe_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(avg_swe = mean(swe, na.rm = TRUE))\n\nggplot(annual_swe, aes(x = year, y = avg_swe)) +\n  geom_line(color = \"blue\", linewidth = 1.2) +\n  geom_point(color = \"darkblue\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"red\") +\n  labs(title = \"Average SWE by Year (All Stations)\",\n       x = \"Year\", y = \"Average SWE (inches)\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\nFig. 1A\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ntemp_data <- df %>%\n  select(year, contains(\"air_temperature_average\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"temp\"\n  ) %>%\n  mutate(temp = as.numeric(temp))\n\nannual_temp <- temp_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(avg_temp = mean(temp, na.rm = TRUE))\n\nggplot(annual_temp, aes(x = year, y = avg_temp)) +\n  geom_line(color = \"tomato\", linewidth = 1.2) +\n  geom_point(color = \"firebrick\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\n  labs(title = \"Average Air Temperature by Year (All Stations)\",\n       x = \"Year\", y = \"Avg Temp (°F)\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNULL\n```\n\n\n:::\n:::\n\n\n\n\nFig. 1B\n\n### Site-by-Site Analysis\n\n#### Bear Lake (322) \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(patchwork)\nbear_swe_data <- df %>%\n  select(year, contains(\"322_snow_water_equivalent\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"swe\"\n  )\n\nbear_swe_data <- bear_swe_data %>%\n  mutate(swe = as.numeric(swe))\n\nbear_annual_swe <- bear_swe_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(bear_avg_swe = mean(swe, na.rm = TRUE)) \n\nbear_swe_plot <- ggplot(bear_annual_swe, aes(x = year, y = bear_avg_swe)) +\n  geom_line(color = \"blue\", linewidth = 1.2) +\n  geom_point(color = \"darkblue\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"red\") +\n  labs(title = \"Average SWE by Year (Bear Lake (322))\",\n       x = \"Year\", y = \"Average SWE (inches)\") +\n  theme_bw()\n\nbear_temp_data <- df %>%\n  select(year, contains(\"322_air_temperature_average\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"temp\"\n  ) %>%\n  mutate(temp = as.numeric(temp))\n\nbear_annual_temp <- bear_temp_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(bear_avg_temp = mean(temp, na.rm = TRUE))\n\nbear_temp_plot <- ggplot(bear_annual_temp, aes(x = year, y = bear_avg_temp)) +\n  geom_line(color = \"tomato\", linewidth = 1.2) +\n  geom_point(color = \"firebrick\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\")\n  labs(title = \"Average Air Temperature by Year (Bear Lake (322))\",\n       x = \"Year\", y = \"Avg Temp (°F)\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNULL\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nbear_swe_plot + bear_temp_plot\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\nFig. 2A\n\n#### Copeland Lake (412)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncope_swe_data <- df %>%\n  select(year, contains(\"412_snow_water_equivalent\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"swe\"\n  )\n\ncope_swe_data <- cope_swe_data %>%\n  mutate(swe = as.numeric(swe))\n\ncope_annual_swe <- cope_swe_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(cope_avg_swe = mean(swe, na.rm = TRUE)) \n\ncope_swe_plot <- ggplot(cope_annual_swe, aes(x = year, y = cope_avg_swe)) +\n  geom_line(color = \"blue\", linewidth = 1.2) +\n  geom_point(color = \"darkblue\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"red\") +\n  labs(title = \"Average SWE by Year (Copeland Lake (412))\",\n       x = \"Year\", y = \"Average SWE (inches)\") +\n  theme_bw()\n\ncope_temp_data <- df %>%\n  select(year, contains(\"412_air_temperature_average\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"temp\"\n  ) %>%\n  mutate(temp = as.numeric(temp))\n\ncope_annual_temp <- cope_temp_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(cope_avg_temp = mean(temp, na.rm = TRUE))\n\ncope_temp_plot <- ggplot(cope_annual_temp, aes(x = year, y = cope_avg_temp)) +\n  geom_line(color = \"tomato\", linewidth = 1.2) +\n  geom_point(color = \"firebrick\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\")\n  labs(title = \"Average Air Temperature by Year (Copeland Lake (412))\",\n       x = \"Year\", y = \"Avg Temp (°F)\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNULL\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncope_swe_plot + cope_temp_plot\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\nFig. 2B\n\n#### Lake Irene (565)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nirene_swe_data <- df %>%\n  select(year, contains(\"565_snow_water_equivalent\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"swe\"\n  )\n\nirene_swe_data <- irene_swe_data %>%\n  mutate(swe = as.numeric(swe))\n\nirene_annual_swe <- irene_swe_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(irene_avg_swe = mean(swe, na.rm = TRUE)) \n\nirene_swe_plot <- ggplot(irene_annual_swe, aes(x = year, y = irene_avg_swe)) +\n  geom_line(color = \"blue\", linewidth = 1.2) +\n  geom_point(color = \"darkblue\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"red\") +\n  labs(title = \"Average SWE by Year (Lake Irene (565))\",\n       x = \"Year\", y = \"Average SWE (inches)\") +\n  theme_bw()\n\nirene_temp_data <- df %>%\n  select(year, contains(\"565_air_temperature_average\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"temp\"\n  ) %>%\n  mutate(temp = as.numeric(temp))\n\nirene_annual_temp <- irene_temp_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(irene_avg_temp = mean(temp, na.rm = TRUE))\n\nirene_temp_plot <- ggplot(irene_annual_temp, aes(x = year, y = irene_avg_temp)) +\n  geom_line(color = \"tomato\", linewidth = 1.2) +\n  geom_point(color = \"firebrick\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\")\n  labs(title = \"Average Air Temperature by Year (Lake Irene (565))\",\n       x = \"Year\", y = \"Avg Temp (°F)\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNULL\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nirene_swe_plot + irene_temp_plot\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\nFig. 2C\n\n#### Phantom Valley (688)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nphantom_swe_data <- df %>%\n  select(year, contains(\"688_snow_water_equivalent\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"swe\"\n  )\n\nphantom_swe_data <- phantom_swe_data %>%\n  mutate(swe = as.numeric(swe))\n\nphantom_annual_swe <- phantom_swe_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(phantom_avg_swe = mean(swe, na.rm = TRUE)) \n\nphantom_swe_plot <- ggplot(phantom_annual_swe, aes(x = year, y = phantom_avg_swe)) +\n  geom_line(color = \"blue\", linewidth = 1.2) +\n  geom_point(color = \"darkblue\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"red\") +\n  labs(title = \"Average SWE by Year (Phantom Valley (688))\",\n       x = \"Year\", y = \"Average SWE (inches)\") +\n  theme_bw()\n\nphantom_temp_data <- df %>%\n  select(year, contains(\"688_air_temperature_average\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"temp\"\n  ) %>%\n  mutate(temp = as.numeric(temp))\n\nphantom_annual_temp <- phantom_temp_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(phantom_avg_temp = mean(temp, na.rm = TRUE))\n\nphantom_temp_plot <- ggplot(phantom_annual_temp, aes(x = year, y = phantom_avg_temp)) +\n  geom_line(color = \"tomato\", linewidth = 1.2) +\n  geom_point(color = \"firebrick\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\")\n  labs(title = \"Average Air Temperature by Year (Phantom Valley (688))\",\n       x = \"Year\", y = \"Avg Temp (°F)\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNULL\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nphantom_swe_plot + phantom_temp_plot\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\nFig. 2D\n\n#### Wild Basin (1042)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nbasin_swe_data <- df %>%\n  select(year, contains(\"1042_snow_water_equivalent\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"swe\"\n  )\n\nbasin_swe_data <- basin_swe_data %>%\n  mutate(swe = as.numeric(swe))\n\nbasin_annual_swe <- basin_swe_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(basin_avg_swe = mean(swe, na.rm = TRUE)) \n\nbasin_swe_plot <- ggplot(basin_annual_swe, aes(x = year, y = basin_avg_swe)) +\n  geom_line(color = \"blue\", linewidth = 1.2) +\n  geom_point(color = \"darkblue\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"red\") +\n  labs(title = \"Average SWE by Year (Wild Basin (1042))\",\n       x = \"Year\", y = \"Average SWE (inches)\") +\n  theme_bw()\n\nbasin_temp_data <- df %>%\n  select(year, contains(\"1042_air_temperature_average\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"temp\"\n  ) %>%\n  mutate(temp = as.numeric(temp))\n\nbasin_annual_temp <- basin_temp_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(basin_avg_temp = mean(temp, na.rm = TRUE))\n\nbasin_temp_plot <- ggplot(basin_annual_temp, aes(x = year, y = basin_avg_temp)) +\n  geom_line(color = \"tomato\", linewidth = 1.2) +\n  geom_point(color = \"firebrick\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\")\n  labs(title = \"Average Air Temperature by Year (Wild Basin (1042))\",\n       x = \"Year\", y = \"Avg Temp (°F)\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNULL\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nbasin_swe_plot + basin_temp_plot\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\nFig. 2E\n\n#### Willow Park (870)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nwillow_swe_data <- df %>%\n  select(year, contains(\"870_snow_water_equivalent\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"swe\"\n  )\n\nwillow_swe_data <- willow_swe_data %>%\n  mutate(swe = as.numeric(swe))\n\nwillow_annual_swe <- willow_swe_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(willow_avg_swe = mean(swe, na.rm = TRUE)) \n\nwillow_swe_plot <- ggplot(willow_annual_swe, aes(x = year, y = willow_avg_swe)) +\n  geom_line(color = \"blue\", linewidth = 1.2) +\n  geom_point(color = \"darkblue\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"red\") +\n  labs(title = \"Average SWE by Year (Willow Park (870))\",\n       x = \"Year\", y = \"Average SWE (inches)\") +\n  theme_bw()\n\nwillow_temp_data <- df %>%\n  select(year, contains(\"870_air_temperature_average\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"temp\"\n  ) %>%\n  mutate(temp = as.numeric(temp))\n\nwillow_annual_temp <- willow_temp_data %>%\n  filter(year < 2025) %>%\n  group_by(year) %>%\n  summarise(willow_avg_temp = mean(temp, na.rm = TRUE))\n\nwillow_temp_plot <- ggplot(willow_annual_temp, aes(x = year, y = willow_avg_temp)) +\n  geom_line(color = \"tomato\", linewidth = 1.2) +\n  geom_point(color = \"firebrick\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\")\n  labs(title = \"Average Air Temperature by Year (Willow Park (870))\",\n       x = \"Year\", y = \"Avg Temp (°F)\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNULL\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nwillow_swe_plot + willow_temp_plot\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\nFig. 2F\n\n### Statistical Analysis\nConducting One-Way ANOVA testing for both the site-based differences in SWE and MAT revealed statistically significant differences, confirming our visual analysis of both variables across each of the six sites. In our ANOVA testing for SWE, there was strong statistical significance that there was site-based variability in SWE (F-Statistic = 1022, P = <2e-16, Fig. 3A). When conducting ANOVA testing for MAT, there was also strong statistical significance for site-based temperature variability (F-Statistic = 333.5, P = <2e-16, Fig. 3B). Our Two-Way ANOVA testing analyzed the effect of MAT and site on SWE, with our results demonstrating that there are statistically significant impacts of MAT on SWE, though not all of the sites exhibited the same MAT/SWE relationship (Fig. 3C). \n\n#### SWE One-Way ANOVA \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)\n\nsite_swe_data <- df %>%\n  select(year, contains(\"snow_water_equivalent\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"swe\"\n  ) %>%\n  mutate(\n    site_code = str_extract(station, \"_\\\\d+_\") %>%\n                str_replace_all(\"_\", \"\")\n  ) %>%\n  arrange(as.numeric(site_code))\n\nswe_anova <- aov(swe ~ site_code, data = site_swe_data)\nsummary(swe_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Df  Sum Sq Mean Sq F value Pr(>F)    \nsite_code       5  239830   47966    1022 <2e-16 ***\nResiduals   37776 1773767      47                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\nFig. 3A\n\n#### TEMP One-Way ANOVA\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nsite_temp_data <- df %>%\n  select(year, contains(\"air_temperature_average\")) %>%\n  pivot_longer(\n    cols = -year,\n    names_to = \"station\",\n    values_to = \"temp\"\n  ) %>%\n  mutate(\n    site_code = str_extract(station, \"_\\\\d+_\") %>%\n                str_replace_all(\"_\", \"\")\n  ) %>%\n  arrange(as.numeric(site_code))\n\ntemp_anova <- aov(temp ~ site_code, data = site_temp_data)\nsummary(temp_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Df  Sum Sq Mean Sq F value Pr(>F)    \nsite_code       5  435442   87088   333.5 <2e-16 ***\nResiduals   37776 9864814     261                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\nFig. 3B\n\n#### Two-Way ANOVA\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndf_merged <- merge(site_temp_data, site_swe_data, by = c(\"site_code\", \"year\"))\n\naov_swe_continuous <- aov(swe ~ temp * site_code, data = df_merged)\nsummary(aov_swe_continuous)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                     Df    Sum Sq  Mean Sq  F value Pr(>F)    \ntemp                  1   2393314  2393314  50201.9 <2e-16 ***\nsite_code             5  77745211 15549042 326154.9 <2e-16 ***\ntemp:site_code        5     39165     7833    164.3 <2e-16 ***\nResiduals      12482022 595065286       48                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\nFig. 3C\n\n### Time Series Analysis \nThrough our use of Time Series Analysis, we were able to observe the raw SWE time series, trends, season year, and remainder for each of the sites. In the raw SWE time series, there are visual seasonal spikes occurring with seasons of snow accumulation. The long term trends section demonstrated that there were slight declines for some sites, such as Lake Irene, which exhibited a more variable trend (Fig. 4). The season year visualization indicates that there are highly consistent annual seasonal patterns of snowpack across the six sites, which is consistent with current literature surrounding snowfall patterns. Within the randomness section, it can be observed that there is a decent amount of unexplained variance in SWE that cannot be explained by temperature. \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(readr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(ggpubr)\nlibrary(tidyverse)\n\nrmnp_clean <- rmnp_clean %>%\n  select(date, contains(c(\"322_snow_water_equivalent\", \"412_snow_water_equivalent\", \"565_snow_water_equivalent\",\"688_snow_water_equivalent\", \"1042_snow_water_equivalent\", \"870_snow_water_equivalent\"))\n  ) %>%\n  rename(Date_col = date) %>%\n  mutate(Date_col = mdy(Date_col)) %>%\n  arrange(Date_col) %>%\n  drop_na()\n\nlibrary(tsibble)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRegistered S3 method overwritten by 'tsibble':\n  method               from \n  as_tibble.grouped_df dplyr\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'tsibble'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following object is masked from 'package:lubridate':\n\n    interval\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, union\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(feasts)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: fabletools\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nswe_long <- rmnp_clean %>%\n  pivot_longer(\n    cols = contains(\"snow_water_equivalent\"),\n    names_to = \"site\",\n    values_to = \"SWE\"\n  ) %>%\n  mutate(site = str_remove(site, \"_snow_water_equivalent_in_start_of_day_values\"))\n\nswe_monthly <- swe_long %>%\n  mutate(month = floor_date(Date_col, \"month\"))%>%\n  group_by(site, month) %>%\n  summarize(mean_swe = mean(SWE, na.rm = TRUE), .groups = \"drop\") %>%\n  mutate(mean_swe = ifelse(is.nan(mean_swe), 0, mean_swe))\n\n\ndaily_dates <- tibble(date = seq.Date(from = min(swe_monthly$month), to = max(swe_monthly$month), by = \"day\")) %>%\n  mutate(month = floor_date(date, \"month\"))\n\nsites <- unique(swe_monthly$site)\n\nfull_daily_grid <- expand_grid(site = sites, date = daily_dates$date) %>%\n  mutate(month = floor_date(date, \"month\"))\n\nswe_filled <- full_daily_grid %>%\n  left_join(swe_monthly, by = c(\"site\", \"month\")) %>%\n  arrange(site, date)\n\nswe_filled <- swe_filled %>%\n  mutate(mean_swe = ifelse(is.na(mean_swe) | is.nan(mean_swe), 0, mean_swe))\n\n\nswe_tsibble <- swe_filled %>%\n  as_tsibble(key = site, index = date) %>%\n  fill_gaps()\n\nswe_tsibble %>%\n  filter(is.na(mean_swe)) %>%\n  count(site)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 0 × 2\n# ℹ 2 variables: site <chr>, n <int>\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ndecomposed <- swe_tsibble %>%\n  model(STL(mean_swe ~ season(window = \"periodic\"))) %>%\n  components()\n\nautoplot(decomposed) + \n  labs(title = \"SWE Decomposition by Site\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\nFig. 4\n\n# Discussion\nIn our initial data visualization, we graphed the annual aggregate snow water equivalent by year for and the mean aggregate temperature by year for the sites in Rocky Mountain National Park. We included lines of best fit for both of the graphical representations of these variables to get a sense for general trends we might be looking at. In the average aggregate snow water equivalent by year data, there appears to be a slight upward trend throughout the 20-year period of analysis (Fig. 1A). Similarly, in the data for the mean aggregate temperature by year there appears to be an increasing trend, though much sharper than the snow water equivalent graph (Fig. 1B). \nFollowing these initial aggregate analyses, we separated each of the sites and conducted the same exploratory analysis for all six over the 20-year period to observe individual variations within each site. Contrary to our hypothesis, four out of the six sites exhibited increased snow water equivalent levels with increasing temperatures over the 20-year period of study (Fig. 2A, 2B, 2E, 2F). This may indicate that increased temperatures may reduce snowfall, but increase the overall density of water content within the snow itself leading to higher recorded snow water equivalents. \nThrough our use of ANOVA analysis we were able to conduct one-way analyses with both individual variables for each study site, as well as observing the relationship between the two variables. Our analysis of snow water content revealed that site number was a strong indicator of the variable, suggesting that site-based differences such as altitude might affect snowpack in relation to temperature (Fig. 3A). Similarly, we found that temperature was similarly impacted by site number, pointing to a difference of variables based on site conditions (Fig. 3B) . In our two-way analysis, we found that around 48% of the variance in snow water equivalence could be explained by temperature, which suggests that additional variables account for the remaining 50% of variance (Fig. 3C). This could be a jumping point for additional study, prompting the exploration of other variables within the data set. \n We used a Seasonal-Trend Decomposition using LOESS (STL) for monthly average snow water equivalent (SWE) data across the six sites. The results of the decomposition were analyzed by components to better understand how SWE changes year over year. The mean_swe graph represents the original time series data, indicating that each site shows strong seasonal SWE peaks between March-April, with Lake Irene consistently having the highest SWE and Copeland Lake and Willow Park rank lowest (Fig. 4). The trend component graph smooths out seasonal variance to show trends year to year, with site differences emerging. Some sites, like Lake Irene and Phantom Valley show declines in SWE post ~2011 specifically (Fig. 4). Other sites, like Copeland Lake, reflect a relatively stable if not slightly increasing SWE trend. These differences between trends suggest site-specific variability in SWE in response to changing weather and climate patterns. More data analysis is needed at the site level to assess how other variables such as elevation or latitude may contribute to differences in trends.  \nThe season_year component captures annual patterns and indicates that SWE is highly seasonal following a similar pattern each year, with the greatest snowpack in March-April, then decreasing during the summer months and accumulating through winter (Fig. 4). The season_week indicates there is no additional weekly pattern to seasonality, but this may not accurately reflect weekly variation as the time series was built on monthly average values to avoid noise in the data. The remainder component represents residuals and displays no major anomalies, suggesting that the STL decomposition captures the structure of the time series well. There are minor outliers, with a spike in 2011 accompanied by variance in the pattern until 2015. These outliers could reflect year to year weather variations and may be influenced by extreme weather events or El Niño/La Niña years. \nThough our study indicates that more research into the effects of climate change on alpine snowpack levels is needed to further explore the relationship between temperature changes and snow water equivalents, it may open new conversations around unexpected results of climate change. Our study is limited by the timespan of our data, which only shows a snapshot of recorded trends relating to snowpack in Rocky Mountain National Park, though further analysis could build upon our study with an expanded time frame. Additionally, our study was limited by the time we had to complete it and the extent of our data analysis skills. The relationship between snow water equivalents and other variables in the data could be further explored, highlighting the extent to which multivariate analysis could explain some of the additional variance. \n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}